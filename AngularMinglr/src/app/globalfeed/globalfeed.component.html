<div class="bg-img">
    <div class="container">
    
        <!-- # creates a reference variable -->
        <form (ngSubmit)="onSubmit()" #textPostForm="ngForm" enctype="multipart/form-data" style="width: 70%;" class='centerPlusMBottom'>
            <div class="form-group">
                <textarea class="form-control" name='postText' id="postText" rows="3" placeholder="Ready to mingle? Create a post here!" maxlength='6000' ngModel required></textarea> <!-- ngModel declares this field as an ngForm value -->
            </div> 
            <div class="form-group">
                <p id="label">Attach an image</p>
                <input type="file" name="image" id="image" (change)="onFileChanged($event)" ngModel>
                <button [disabled]='!textPostForm.form.valid' class="btn btn-dark" type='submit' id="submit">Post it!</button>
            </div> 
        </form>
    
       
        <div *ngFor='let post of postList'>
            <div class="card centerPlusMTop contentBox" style="width: 70%;"> 
                <div class="card-body">
                    <div class='row'>
                        <h5 class="card-title col">{{post["username"]}}</h5>
                        <span *ngIf="currentUser['id'] == post['userID']">
                            <i class="fas fa-pencil-alt" id="editButton" title='edit post' (click)="editMode(post)"></i>
                            <button id='deleteButton' (click)='deletePost(post)' title='Delete this post?'>
                                <p class='deletePost col'>X</p>
                            </button>
                        </span>
                    </div>
                    <h6 class="card-subtitle mb-2 text-muted">{{today | date:'shortDate'}} at {{today | date:'shortTime'}}</h6>
                    <p *ngIf="editModePostId != post['id']" class="card-text">{{post["postText"]}}</p>
                    <div *ngIf="editModePostId == post['id']">
                        <form #editPostForm="ngForm" (ngSubmit)="editPost(post)">
                            <textarea class="form-control" name='editedPostText' id="editedPostText" rows="3" maxlength='6000' required [(ngModel)]="editedPostText"></textarea>
                            <div class="form-group row">
                                <button class="btn btn-dark col-4" type="reset" (click)="cancelEdit()">Cancel</button>
                                <button [disabled]='!editPostForm.form.valid' class="btn btn-dark col-4" type='submit' id="submitChanges">Submit changes</button>
                            </div>
                        </form>
                    </div>
                    <div *ngIf='retrievedImage'>
                        <img [src]="retrievedImage">
                    </div>
                    <div class='row'>
                        <div class='triangle-up' title='upvote' (click)='upvotePost(post)'> </div>
                        <div class='triangle-down' title='downvote' (click)='downvotePost(post)'></div>   
                    </div>
                    <div class="row">
                        <p id='voteNum1'>{{post["upvote"]}}</p>
                        <p id='voteNum2'>{{post["downvote"]}}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    
    
    
